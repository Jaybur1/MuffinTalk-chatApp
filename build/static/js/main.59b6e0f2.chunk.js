(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{1:function(e,t){e.exports={COMMUNITY_CHAT:"COMMUNITY_CHAT",USER_CONNECTED:"USER_CONNECTED",MESSAGE_RECIEVED:"MESSAGE_RECIEVED",MESSAGE_SENT:"MESSAGE_SENT",USER_DISCONNECTED:"USER_DISCONNECTED",TYPING:"TYPING",VERIFY_USER:"VERIFY_USER",LOGOUT:"LOGOUT",PRIVATE_MESSAGE:"PRIVATE_MESSAGE",NEW_CHAT_USER:"NEW_CHAT_USER"}},39:function(e,t,a){var n=a(81),s=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return e.filter(function(e){return e!==t}).join(" & ")||"Empty Users"},c=function(e){return"".concat(e.getHours(),":").concat(("0"+e.getMinutes()).slice(-2))};e.exports={createUser:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.name,a=void 0===t?"":t,s=e.socketId,c=void 0===s?null:s;return{id:n(),name:a,socketId:c}},createMessage:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.message,a=void 0===t?"":t,s=e.sender,r=void 0===s?"":s;return{id:n(),time:c(new Date(Date.now())),message:a,sender:r}},createChat:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.messages,a=void 0===t?[]:t,c=(e.name,e.users),r=void 0===c?[]:c,i=e.isGeneral,o=void 0!==i&&i;return{id:n(),name:o?"General":s(r),messages:a,users:r,typingUsers:[],isGeneral:o}},createChatNameFromUsers:s}},48:function(e,t,a){e.exports=a(89)},53:function(e,t,a){},77:function(e,t){},87:function(e,t,a){},89:function(e,t,a){"use strict";a.r(t);var n=a(0),s=a.n(n),c=a(37),r=a.n(c),i=(a(53),a(3)),o=a(4),l=a(6),u=a(5),m=a(7),d=a(38),h=a.n(d),p=a(2),v=a(1),E=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).setUser=function(e){var t=e.user,n=e.isUser;console.log(t,n),n?a.setError("User name taken"):(a.setError(""),a.props.setUser(t))},a.setError=function(e){a.setState({error:e})},a.state={nickname:"",error:""},a.handleSubmit=a.handleSubmit.bind(Object(p.a)(Object(p.a)(a))),a.handleChange=a.handleChange.bind(Object(p.a)(Object(p.a)(a))),a}return Object(m.a)(t,e),Object(o.a)(t,[{key:"handleSubmit",value:function(e){e.preventDefault(),console.log(this.state.nickname);var t=this.props.socket,a=this.state.nickname;t.emit(v.VERIFY_USER,a,this.setUser),this.setState({nickname:""})}},{key:"handleChange",value:function(e){this.setState({nickname:e.target.value})}},{key:"render",value:function(){var e=this,t=this.state,a=t.nickname,n=t.error;return s.a.createElement("div",{className:"login"},s.a.createElement("div",{className:"login-form-logo"},s.a.createElement("img",{src:"https://vectr.com/jaybur/efqGEpvOy.png?width=640&height=640&select=efqGEpvOypage0",alt:"MuffinTalk-cat-logo"})),s.a.createElement("form",{onSubmit:this.handleSubmit,className:"login-form"},s.a.createElement("label",{htmlFor:"nickname"},s.a.createElement("h2",{id:"login-label"},"Got a nickname?")),s.a.createElement("input",{ref:function(t){e.textInput=t},type:"text",id:"nickname",value:a,onChange:this.handleChange,placeholder:"Type your cool name here"}),s.a.createElement("div",{className:"error"},n||null)))}}]),t}(n.Component),f=a(47),g=a(23),C=function(e){function t(){return Object(i.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this.props,t=e.name,a=e.lastMessage,n=e.active,c=e.onClick;return s.a.createElement("div",{className:"user ".concat(n?"active":""),onClick:c},s.a.createElement("div",{className:"user-photo"},t[0].toUpperCase()),s.a.createElement("div",{className:"user-info"},s.a.createElement("div",{className:"name"},t),a&&s.a.createElement("div",{className:"last-message"},a)))}}]),t}(n.Component);C.defaultProps={lastMessage:"",active:!1,onClick:function(){}};var S=a(8),b=a(39),y=a(40),O=a.n(y),N=a(41),T=a.n(N),k=a(42),U=a.n(k),j=a(43),M=a.n(j),_=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).handleChange=function(e){a.setState({search:e.target.value})},a.handleSubmit=function(e){e.preventDefault();var t=a.state.search,n=a.props.onSendPrivateMessage;a.setState({search:""}),n(t)},a.addChatForUser=function(e){a.setState({activeSideBar:t.type.CHATS}),a.props.onSendPrivateMessage(e)},a.setActiveSideBar=function(e){a.setState({activeSideBar:e})},a.state={search:"",activeSideBar:t.type.CHATS},a}return Object(m.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this,a=this.props,n=a.chats,c=a.activeChat,r=a.user,i=a.setActiveChat,o=a.logout,l=a.users,u=this.state,m=u.search,d=u.activeSideBar;return s.a.createElement("div",{id:"side-bar"},s.a.createElement("div",{className:"heading"},s.a.createElement("div",{className:"app-name"},"MaffinTalk Chat",s.a.createElement(O.a,null)),s.a.createElement("div",{className:"menu"},s.a.createElement(T.a,null))),s.a.createElement("form",{onSubmit:this.handleSubmit,className:"search"},s.a.createElement("i",{className:"search-icon"},s.a.createElement(U.a,null)),s.a.createElement("input",{onChange:this.handleChange,placeholder:"Search user",value:m,type:"text"}),s.a.createElement("div",{className:"plus"})),s.a.createElement("div",{className:"side-bar-select"},s.a.createElement("div",{className:"side-bar-select__option ".concat(d===t.type.CHATS?"active":""),onClick:function(){e.setActiveSideBar(t.type.CHATS)}},s.a.createElement("span",null,"Chats")),s.a.createElement("div",{className:"side-bar-select__option ".concat(d===t.type.USERS?"active":""),onClick:function(){e.setActiveSideBar(t.type.USERS)}},s.a.createElement("span",null,"Users"))),s.a.createElement("div",{className:"users",ref:"users",onClick:function(t){t.target===e.refs.user&&i(null)}},d===t.type.CHATS?n.map(function(t){return t.name?s.a.createElement(C,{key:t.id,name:t.isGeneral?t.name:Object(b.createChatNameFromUsers)(t.users,r.name),lastMessage:Object(S.get)(Object(S.last)(t.messages),"message",""),active:c.id===t.id,onClick:function(){e.props.setActiveChat(t)}}):null}):Object(S.differenceBy)(l,[r],"name").map(function(t){return s.a.createElement(C,{key:t.id,name:t.name,onClick:function(){e.addChatForUser(t.name)}})})),s.a.createElement("div",{className:"current-user"},s.a.createElement("span",null,r.name),s.a.createElement("div",{onClick:function(){o()},title:"Logout",className:"logout"},s.a.createElement(M.a,null))))}}]),t}(n.Component);_.type={CHATS:"chats",USERS:"users"};var A=_,I=a(44),R=a.n(I),D=a(45),G=a.n(D),w=a(46),H=a.n(w);var P=function(e){var t=e.name,a=e.numberOfUsers;return s.a.createElement("div",{className:"chat-header"},s.a.createElement("div",{className:"user-info"},s.a.createElement("div",{className:"user-name"},t),s.a.createElement("div",{className:"status"},s.a.createElement("div",{className:"indicator"}),s.a.createElement("span",null,a||null))),s.a.createElement("div",{className:"options"},s.a.createElement(R.a,null),s.a.createElement(G.a,null),s.a.createElement(H.a,null)))},V=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).scrollDown=a.scrollDown.bind(Object(p.a)(Object(p.a)(a))),a}return Object(m.a)(t,e),Object(o.a)(t,[{key:"scrollDown",value:function(){var e=this.refs.container;e.scrollTop=e.scrollHeight}},{key:"componentDidMount",value:function(){this.scrollDown()}},{key:"componentDidUpdate",value:function(){this.scrollDown()}},{key:"render",value:function(){var e=this.props,t=e.messages,a=e.user,n=e.typingUsers;return s.a.createElement("div",{ref:"container",className:"thread-container"},s.a.createElement("div",{className:"thread"},t.map(function(e){return s.a.createElement("div",{key:e.id,className:"message-container ".concat(e.sender===a.name&&"right")},s.a.createElement("div",{className:"time"},e.time),s.a.createElement("div",{className:"data"},s.a.createElement("div",{className:"message"},e.message),s.a.createElement("div",{className:"name"},e.sender)))}),n.map(function(e){return s.a.createElement("div",{key:e,className:"typing-user"},"".concat(e," is typing . . ."))})))}}]),t}(n.Component),Y=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).handleKeyUp=function(e){13!==e.keyCode&&a.sendTyping()},a.sendTyping=function(){a.lastUpdateTime=Date.now(),a.state.isTyping||(a.setState({isTyping:!0}),a.props.sendTyping(!0),a.startCheckingTyping())},a.startCheckingTyping=function(){console.log("Typing"),a.typingInterval=setInterval(function(){Date.now()-a.lastUpdateTime>300&&(a.setState({isTyping:!1}),a.stopCheckingTyping())},300)},a.stopCheckingTyping=function(){console.log("not typing"),a.typingInterval&&(clearInterval(a.typingInterval),a.props.sendTyping(!1))},a.handleChange=function(e){a.setState({message:e.target.value})},a.handleSubmit=function(e){e.preventDefault(),a.sendMessage(),a.setState({message:""})},a.sendMessage=function(){a.props.sendMessage(a.state.message)},a.state={message:"",isTyping:!1},a.handleSubmit=a.handleSubmit.bind(Object(p.a)(Object(p.a)(a))),a.handleChange=a.handleChange.bind(Object(p.a)(Object(p.a)(a))),a.handleKeyUp=a.handleKeyUp.bind(Object(p.a)(Object(p.a)(a))),a}return Object(m.a)(t,e),Object(o.a)(t,[{key:"componentWillUnmount",value:function(){this.stopCheckingTyping()}},{key:"render",value:function(){var e=this.state.message;return s.a.createElement("div",{className:"message-input"},s.a.createElement("form",{onSubmit:this.handleSubmit,className:"message-form"},s.a.createElement("input",{id:"message",ref:"messageinput",type:"text",className:"form-control",value:e,autoComplete:"off",placeholder:"type your message here",onKeyUp:this.handleKeyUp,onChange:this.handleChange}),s.a.createElement("button",{disabled:e.length<1,type:"submit",className:"send"},"Send")))}}]),t}(n.Component),B=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).initSocket=function(e){e.emit(v.COMMUNITY_CHAT,a.resetChat),e.on(v.PRIVATE_MESSAGE,a.addChat),e.on("connect",function(){e.emit(v.COMMUNITY_CHAT,a.resetChat)}),e.on(v.USER_DISCONNECTED,function(e){var t=Object(S.differenceBy)(a.state.users,Object(S.values)(e),"id");a.removeUserFromChat(t),a.setState({users:Object(S.values)(e)})}),e.on(v.USER_CONNECTED,function(e){a.setState({users:Object(S.values)(e)})}),e.on(v.NEW_CHAT_USER,a.addUserToChat)},a.sendPrivateMessage=function(e){var t=a.props,n=t.socket,s=t.user,c=a.state.activeChat;n.emit(v.PRIVATE_MESSAGE,{reciever:e,sender:s.name,activeChat:c})},a.addUserToChat=function(e){var t=e.chatId,n=e.newUser,s=a.state.chats.map(function(e){return e.id===t?Object.assign({},e,{user:[].concat(Object(g.a)(e.users),[n])}):e});a.setState({chats:s})},a.removeUserFromChat=function(e){var t=a.state.chats.map(function(t){var a=Object(S.difference)(t.users,e.map(function(e){return e.name}));return Object(f.a)({},t,{users:a})});a.setState({chats:t})},a.resetChat=function(e){return a.addChat(e,!0)},a.addChat=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=a.props.socket,s=a.state.chats,c=t?[e]:[].concat(Object(g.a)(s),[e]);a.setState({chats:c,activeChat:t?e:a.state.activeChat});var r="".concat(v.MESSAGE_RECIEVED,"-").concat(e.id),i="".concat(v.TYPING,"-").concat(e.id);n.on(i,a.updateTypingInChat(e.id)),n.on(r,a.addMessageToChat(e.id))},a.addMessageToChat=function(e){return function(t){var n=a.state.chats.map(function(a){return a.id===e&&a.messages.push(t),a});a.setState({chats:n})}},a.updateTypingInChat=function(e){return function(t){var n=t.isTyping,s=t.user;if(s!==a.props.user.name){var c=a.state.chats.map(function(t){return t.id===e&&(n&&!t.typingUsers.includes(s)?t.typingUsers.push(s):!n&&t.typingUsers.includes(s)&&(t.typingUsers=t.typingUsers.filter(function(e){return e!==s}))),t});a.setState({chats:c})}}},a.sendMessage=function(e,t){a.props.socket.emit(v.MESSAGE_SENT,{chatId:e,message:t})},a.sendTyping=function(e,t){a.props.socket.emit(v.TYPING,{chatId:e,isTyping:t})},a.setActiveChat=function(e){a.setState({activeChat:e})},a.state={chats:[],activeChat:null,users:[]},a}return Object(m.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){var e=this.props.socket;this.initSocket(e)}},{key:"componentWillUnmount",value:function(){var e=this.props.socket;e.off(v.PRIVATE_MESSAGE),e.off(v.USER_CONNECTED),e.off(v.USER_DISCONNECTED),e.off(v.NEW_CHAT_USER)}},{key:"render",value:function(){var e=this,t=this.props,a=t.user,n=t.logout,c=this.state,r=c.chats,i=c.activeChat,o=c.users;return s.a.createElement("div",{className:"container"},s.a.createElement(A,{users:o,logout:n,chats:r,user:a,activeChat:i,setActiveChat:this.setActiveChat,onSendPrivateMessage:this.sendPrivateMessage}),s.a.createElement("div",{className:"chat-room-container"},null!==i?s.a.createElement("div",{className:"chat-room"},s.a.createElement(P,{name:i.name}),s.a.createElement(V,{messages:i.messages,user:a,typingUsers:i.typingUsers}),s.a.createElement(Y,{sendMessage:function(t){e.sendMessage(i.id,t)},sendTyping:function(t){console.log(i.id),e.sendTyping(i.id,t)}})):s.a.createElement("div",{className:"chat-room choose"},s.a.createElement("h3",null,"Choose a Chat"))))}}]),t}(n.Component),F="/",W=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).initSocket=function(){var e=h()(F);e.on("connect",function(){a.state.user?a.reconnect(e):console.log("Connected")}),a.setState({socket:e})},a.reconnect=function(e){e.emit(v.VERIFY_USER,a.state.user.name,function(e){var t=e.isUser,n=e.user;t?a.state({user:null}):a.setUser(n)})},a.setUser=function(e){a.state.socket.emit(v.USER_CONNECTED,e),a.setState({user:e})},a.logout=function(){a.state.socket.emit(v.LOGOUT),a.setState({user:null})},a.state={socket:null,user:null},a}return Object(m.a)(t,e),Object(o.a)(t,[{key:"componentWillMount",value:function(){this.initSocket()}},{key:"render",value:function(){var e=this.state,t=e.socket,a=e.user;return s.a.createElement("div",{className:"container"},a?s.a.createElement(B,{socket:t,user:a,logout:this.logout}):s.a.createElement(E,{socket:t,setUser:this.setUser}))}}]),t}(n.Component),x=(a(87),function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={title:"MuffinTalk"},a}return Object(m.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return s.a.createElement("div",null,s.a.createElement(W,{title:this.state.title}))}}]),t}(n.Component));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(s.a.createElement(x,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[48,2,1]]]);
//# sourceMappingURL=main.59b6e0f2.chunk.js.map